"use strict";var numeric="undefined"==typeof exports?function r(){}:exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function r(n,e){var i,t,u,$;for(void 0===e&&(e=15),u=.5,i=new Date;;){for(u*=2,$=u;$>3;$-=4)n(),n(),n(),n();for(;$>0;)n(),$--;if((t=new Date)-i>e)break}for($=u;$>3;$-=4)n(),n(),n(),n();for(;$>0;)n(),$--;return 1e3*(3*u-1)/((t=new Date)-i)},numeric._myIndexOf=function r(n){var e,i=this.length;for(e=0;e<i;++e)if(this[e]===n)return e;return -1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function r(n){function e(r){if(0===r)return"0";if(isNaN(r))return"NaN";if(r<0)return"-"+e(-r);if(isFinite(r)){var n=Math.floor(Math.log(r)/Math.log(10)),i=r/Math.pow(10,n),t=i.toPrecision(numeric.precision);return 10===parseFloat(t)&&(n++,t=(i=1).toPrecision(numeric.precision)),parseFloat(t).toString()+"e"+n.toString()}return"Infinity"}var i=[];function t(r){if(void 0===r)return i.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof r)return i.push('"'+r+'"'),!1;if("boolean"==typeof r)return i.push(r.toString()),!1;if("number"==typeof r){var n,u=e(r),$=r.toPrecision(numeric.precision),o=parseFloat(r.toString()).toString(),c=[u,$,o,parseFloat($).toString(),parseFloat(o).toString()];for(n=1;n<c.length;n++)c[n].length<u.length&&(u=c[n]);return i.push(Array(numeric.precision+8-u.length).join(" ")+u),!1}if(null===r)return i.push("null"),!1;if("function"==typeof r){i.push(r.toString());var _=!1;for(n in r)r.hasOwnProperty(n)&&(_?i.push(",\n"):i.push("\n{"),_=!0,i.push(n),i.push(": \n"),t(r[n]));return _&&i.push("}\n"),!0}if(r instanceof Array){if(r.length>numeric.largeArray)return i.push("...Large Array..."),!0;var _=!1;for(i.push("["),n=0;n<r.length;n++)n>0&&(i.push(","),_&&i.push("\n ")),_=t(r[n]);return i.push("]"),!0}i.push("{");var _=!1;for(n in r)r.hasOwnProperty(n)&&(_&&i.push(",\n"),_=!0,i.push(n),i.push(": \n"),t(r[n]));return i.push("}"),!0}return t(n),i.join("")},numeric.parseDate=function r(n){function e(r){if("string"==typeof r)return Date.parse(r.replace(/-/g,"/"));if(!(r instanceof Array))throw Error("parseDate: parameter must be arrays of strings");var n,i=[];for(n=0;n<r.length;n++)i[n]=e(r[n]);return i}return e(n)},numeric.parseFloat=function r(n){function e(r){if("string"==typeof r)return parseFloat(r);if(!(r instanceof Array))throw Error("parseFloat: parameter must be arrays of strings");var n,i=[];for(n=0;n<r.length;n++)i[n]=e(r[n]);return i}return e(n)},numeric.parseCSV=function r(n){var e=n.split("\n"),i=[],t=/(([^'",]*)|('[^']*')|("[^"]*")),/g,u=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,$=function(r){return r.substr(0,r.length-1)},o=0;for(_=0;_<e.length;_++){var c,_,f,m=(e[_]+",").match(t);if(m.length>0){for(c=0,i[o]=[];c<m.length;c++)f=$(m[c]),u.test(f)?i[o][c]=parseFloat(f):i[o][c]=f;o++}}return i},numeric.toCSV=function r(n){var e,i,t,u,$,o,c=numeric.dim(n);for(e=0,t=c[0],u=c[1],o=[];e<t;e++){for(i=0,$=[];i<t;i++)$[i]=n[e][i].toString();o[e]=$.join(", ")}return o.join("\n")+"\n"},numeric.getURL=function r(n){var e=new XMLHttpRequest;return e.open("GET",n,!1),e.send(),e},numeric.imageURL=function r(n){function e(r){var n,e,i,t,u,$,o,c,_=r.length,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",m="";for(n=0;n<_;n+=3)e=r[n],i=r[n+1],t=r[n+2],u=e>>2,$=((3&e)<<4)+(i>>4),o=((15&i)<<2)+(t>>6),c=63&t,n+1>=_?o=c=64:n+2>=_&&(c=64),m+=f.charAt(u)+f.charAt($)+f.charAt(o)+f.charAt(c);return m}function i(r,n,e){void 0===n&&(n=0),void 0===e&&(e=r.length);var i,t=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],u=-1,$=0;for(r.length,i=n;i<e;i++)$=(u^r[i])&255,u=u>>>8^t[$];return -1^u}var t,u,$,o,c,_,f,m,s,a,x=n[0].length,h=n[0][0].length,l=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,h>>24&255,h>>16&255,h>>8&255,255&h,x>>24&255,x>>16&255,x>>8&255,255&x,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(f=0,a=i(l,12,29),l[29]=a>>24&255,l[30]=a>>16&255,l[31]=a>>8&255,l[32]=255&a,t=1,u=0;f<x;f++){for(f<x-1?l.push(0):l.push(1),c=3*h+1+(0===f)&255,_=3*h+1+(0===f)>>8&255,l.push(c),l.push(_),l.push(255&~c),l.push(255&~_),0===f&&l.push(0),m=0;m<h;m++)for($=0;$<3;$++)u=(u+(t=(t+(c=(c=n[$][f][m])>255?255:c<0?0:Math.round(c)))%65521))%65521,l.push(c);l.push(0)}return s=(u<<16)+t,l.push(s>>24&255),l.push(s>>16&255),l.push(s>>8&255),l.push(255&s),o=l.length-41,l[33]=o>>24&255,l[34]=o>>16&255,l[35]=o>>8&255,l[36]=255&o,a=i(l,37),l.push(a>>24&255),l.push(a>>16&255),l.push(a>>8&255),l.push(255&a),l.push(0),l.push(0),l.push(0),l.push(0),l.push(73),l.push(69),l.push(78),l.push(68),l.push(174),l.push(66),l.push(96),l.push(130),"data:image/png;base64,"+e(l)},numeric._dim=function r(n){for(var e=[];"object"==typeof n;)e.push(n.length),n=n[0];return e},numeric.dim=function r(n){var e,i;if("object"==typeof n)return"object"==typeof(e=n[0])?"object"==typeof(i=e[0])?numeric._dim(n):[n.length,e.length]:[n.length];return[]},numeric.mapreduce=function r(n,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+';\nif(typeof x === "number") { var xi = x; '+n+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+n+";\n    xi = x[i-1];\n    "+n+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+n+"\n}\nreturn accum;")},numeric.mapreduce2=function r(n,e){return Function("x","var n = x.length;\nvar i,xi;\n"+e+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+n+";\n}\nreturn accum;")},numeric.same=function r(n,e){var i,t;if(!(n instanceof Array)||!(e instanceof Array)||(t=n.length)!==e.length)return!1;for(i=0;i<t;i++)if(n[i]!==e[i]&&("object"!=typeof n[i]||!r(n[i],e[i])))return!1;return!0},numeric.rep=function r(n,e,i){void 0===i&&(i=0);var t,u=n[i],$=Array(u);if(i===n.length-1){for(t=u-2;t>=0;t-=2)$[t+1]=e,$[t]=e;return -1===t&&($[0]=e),$}for(t=u-1;t>=0;t--)$[t]=numeric.rep(n,e,i+1);return $},numeric.dotMMsmall=function r(n,e){var i,t,u,$,o,c,_,f,m,s,a;for($=n.length,o=e.length,c=e[0].length,_=Array($),i=$-1;i>=0;i--){for(f=Array(c),m=n[i],u=c-1;u>=0;u--){for(s=m[o-1]*e[o-1][u],t=o-2;t>=1;t-=2)a=t-1,s+=m[t]*e[t][u]+m[a]*e[a][u];0===t&&(s+=m[0]*e[0][u]),f[u]=s}_[i]=f}return _},numeric._getCol=function r(n,e,i){var t,u=n.length;for(t=u-1;t>0;--t)i[t]=n[t][e],i[--t]=n[t][e];0===t&&(i[0]=n[0][e])},numeric.dotMMbig=function r(n,e){var i,t,u,$,o=numeric._getCol,c=e.length,_=Array(c),f=n.length,m=e[0].length,s=Array(f),a=numeric.dotVV;for(--c,i=--f;-1!==i;--i)s[i]=Array(m);for(i=--m;-1!==i;--i)for(o(e,i,_),t=f;-1!==t;--t)u=0,$=n[t],s[t][i]=a($,_);return s},numeric.dotMV=function r(n,e){var i,t=n.length;e.length;var u=Array(t),$=numeric.dotVV;for(i=t-1;i>=0;i--)u[i]=$(n[i],e);return u},numeric.dotVM=function r(n,e){var i,t,u,$,o,c,_;for(u=n.length,o=Array($=e[0].length),t=$-1;t>=0;t--){for(c=n[u-1]*e[u-1][t],i=u-2;i>=1;i-=2)_=i-1,c+=n[i]*e[i][t]+n[_]*e[_][t];0===i&&(c+=n[0]*e[0][t]),o[t]=c}return o},numeric.dotVV=function r(n,e){var i,t,u=n.length,$=n[u-1]*e[u-1];for(i=u-2;i>=1;i-=2)t=i-1,$+=n[i]*e[i]+n[t]*e[t];return 0===i&&($+=n[0]*e[0]),$},numeric.dot=function r(n,e){var i=numeric.dim;switch(1e3*i(n).length+i(e).length){case 2002:if(e.length<10)return numeric.dotMMsmall(n,e);return numeric.dotMMbig(n,e);case 2001:return numeric.dotMV(n,e);case 1002:return numeric.dotVM(n,e);case 1001:return numeric.dotVV(n,e);case 1e3:return numeric.mulVS(n,e);case 1:return numeric.mulSV(n,e);case 0:return n*e;default:throw Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function r(n){var e,i,t,u,$=n.length,o=Array($);for(e=$-1;e>=0;e--){for(u=Array($),i=e+2,t=$-1;t>=i;t-=2)u[t]=0,u[t-1]=0;for(t>e&&(u[t]=0),u[e]=n[e],t=e-1;t>=1;t-=2)u[t]=0,u[t-1]=0;0===t&&(u[0]=0),o[e]=u}return o},numeric.getDiag=function(r){var n,e=Math.min(r.length,r[0].length),i=Array(e);for(n=e-1;n>=1;--n)i[n]=r[n][n],i[--n]=r[n][n];return 0===n&&(i[0]=r[0][0]),i},numeric.identity=function r(n){return numeric.diag(numeric.rep([n],1))},numeric.pointwise=function r(n,e,i){void 0===i&&(i="");var t,u,$=[],o=/\[i\]$/,c="",_=!1;for(t=0;t<n.length;t++)o.test(n[t])?c=u=n[t].substring(0,n[t].length-3):u=n[t],"ret"===u&&(_=!0),$.push(u);return $[n.length]="_s",$[n.length+1]="_k",$[n.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+c+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(_?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+n.join(",")+",_s,_k+1);\n    return ret;\n}\n"+i+"\nfor(i=_n-1;i!==-1;--i) {\n    "+e+"\n}\nreturn ret;",Function.apply(null,$)},numeric.pointwise2=function r(n,e,i){void 0===i&&(i="");var t,u,$=[],o=/\[i\]$/,c="",_=!1;for(t=0;t<n.length;t++)o.test(n[t])?c=u=n[t].substring(0,n[t].length-3):u=n[t],"ret"===u&&(_=!0),$.push(u);return $[n.length]="var _n = "+c+".length;\nvar i"+(_?"":", ret = Array(_n)")+";\n"+i+"\nfor(i=_n-1;i!==-1;--i) {\n"+e+"\n}\nreturn ret;",Function.apply(null,$)},numeric._biforeach=function r(n,e,i,t,u){if(t===i.length-1){u(n,e);return}var $,o=i[t];for($=o-1;$>=0;$--)r("object"==typeof n?n[$]:n,"object"==typeof e?e[$]:e,i,t+1,u)},numeric._biforeach2=function r(n,e,i,t,u){if(t===i.length-1)return u(n,e);var $,o=i[t],c=Array(o);for($=o-1;$>=0;--$)c[$]=r("object"==typeof n?n[$]:n,"object"==typeof e?e[$]:e,i,t+1,u);return c},numeric._foreach=function r(n,e,i,t){if(i===e.length-1){t(n);return}var u,$=e[i];for(u=$-1;u>=0;u--)r(n[u],e,i+1,t)},numeric._foreach2=function r(n,e,i,t){if(i===e.length-1)return t(n);var u,$=e[i],o=Array($);for(u=$-1;u>=0;u--)o[u]=r(n[u],e,i+1,t);return o},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var r,n;for(r=0;r<numeric.mathfuns2.length;++r)n=numeric.mathfuns2[r],numeric.ops2[n]=n;for(r in numeric.ops2)if(numeric.ops2.hasOwnProperty(r)){n=numeric.ops2[r];var e,i,t="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,r)?(t="var "+n+" = Math."+n+";\n",e=function(r,e,i){return r+" = "+n+"("+e+","+i+")"},i=function(r,e){return r+" = "+n+"("+r+","+e+")"}):(e=function(r,e,i){return r+" = "+e+" "+n+" "+i},i=numeric.opseq.hasOwnProperty(r+"eq")?function(r,e){return r+" "+n+"= "+e}:function(r,e){return r+" = "+r+" "+n+" "+e}),numeric[r+"VV"]=numeric.pointwise2(["x[i]","y[i]"],e("ret[i]","x[i]","y[i]"),t),numeric[r+"SV"]=numeric.pointwise2(["x","y[i]"],e("ret[i]","x","y[i]"),t),numeric[r+"VS"]=numeric.pointwise2(["x[i]","y"],e("ret[i]","x[i]","y"),t),numeric[r]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+r+"VV, VS = numeric."+r+"VS, SV = numeric."+r+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+i("x","y")+"\n}\nreturn x;\n"),numeric[n]=numeric[r],numeric[r+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],i("ret[i]","x[i]"),t),numeric[r+"eqS"]=numeric.pointwise2(["ret[i]","x"],i("ret[i]","x"),t),numeric[r+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+r+"eqV, S = numeric."+r+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(r=0;r<numeric.mathfuns2.length;++r)n=numeric.mathfuns2[r],delete numeric.ops2[n];for(r=0;r<numeric.mathfuns.length;++r)n=numeric.mathfuns[r],numeric.ops1[n]=n;for(r in numeric.ops1)numeric.ops1.hasOwnProperty(r)&&(t="",n=numeric.ops1[r],-1!==numeric.myIndexOf.call(numeric.mathfuns,r)&&Math.hasOwnProperty(n)&&(t="var "+n+" = Math."+n+";\n"),numeric[r+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+n+"(ret[i]);",t),numeric[r+"eq"]=Function("x",'if(typeof x !== "object") return '+n+"x\nvar i;\nvar V = numeric."+r+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[r+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+n+"(x[i]);",t),numeric[r]=Function("x",'if(typeof x !== "object") return '+n+"(x)\nvar i;\nvar V = numeric."+r+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(r=0;r<numeric.mathfuns.length;++r)n=numeric.mathfuns[r],delete numeric.ops1[n];for(r in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(r)&&(n=numeric.mapreducers[r],numeric[r+"V"]=numeric.mapreduce2(n[0],n[1]),numeric[r]=Function("x","s","k",n[1]+'if(typeof x !== "object") {    xi = x;\n'+n[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+r+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+n[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function r(n,e){return"object"==typeof n?"object"==typeof e?numeric.truncVV(n,e):numeric.truncVS(n,e):"object"==typeof e?numeric.truncSV(n,e):Math.round(n/e)*e},numeric.inv=function r(n){var e,i,t,n,u,$,o,c,_=numeric.dim(n),f=Math.abs,m=_[0],s=_[1],a=numeric.clone(n),x=numeric.identity(m);for(i=0;i<s;++i){var h=-1,l=-1;for(e=i;e!==m;++e)(t=f(a[e][i]))>l&&(h=e,l=t);for($=a[h],a[h]=a[i],a[i]=$,c=x[h],x[h]=x[i],x[i]=c,n=$[i],t=i;t!==s;++t)$[t]/=n;for(t=s-1;-1!==t;--t)c[t]/=n;for(e=m-1;-1!==e;--e)if(e!==i){for(u=a[e],o=x[e],n=u[i],t=i+1;t!==s;++t)u[t]-=$[t]*n;for(t=s-1;t>0;--t)o[t]-=c[t]*n,--t,o[t]-=c[t]*n;0===t&&(o[0]-=c[0]*n)}}return x},numeric.det=function r(n){var e=numeric.dim(n);if(2!==e.length||e[0]!==e[1])throw Error("numeric: det() only works on square matrices");var i,t,u,$,o,c,_,f,m=e[0],s=1,a=numeric.clone(n);for(t=0;t<m-1;t++){for(u=t,i=t+1;i<m;i++)Math.abs(a[i][t])>Math.abs(a[u][t])&&(u=i);for(u!==t&&(_=a[u],a[u]=a[t],a[t]=_,s*=-1),$=a[t],i=t+1;i<m;i++){for(c=(o=a[i])[t]/$[t],u=t+1;u<m-1;u+=2)f=u+1,o[u]-=$[u]*c,o[f]-=$[f]*c;u!==m&&(o[u]-=$[u]*c)}if(0===$[t])return 0;s*=$[t]}return s*a[t][t]},numeric.transpose=function r(n){var e,i,t,u,$,o=n.length,c=n[0].length,_=Array(c);for(i=0;i<c;i++)_[i]=Array(o);for(e=o-1;e>=1;e-=2){for(u=n[e],t=n[e-1],i=c-1;i>=1;--i)($=_[i])[e]=u[i],$[e-1]=t[i],($=_[--i])[e]=u[i],$[e-1]=t[i];0===i&&(($=_[0])[e]=u[0],$[e-1]=t[0])}if(0===e){for(t=n[0],i=c-1;i>=1;--i)_[i][0]=t[i],_[--i][0]=t[i];0===i&&(_[0][0]=t[0])}return _},numeric.negtranspose=function r(n){var e,i,t,u,$,o=n.length,c=n[0].length,_=Array(c);for(i=0;i<c;i++)_[i]=Array(o);for(e=o-1;e>=1;e-=2){for(u=n[e],t=n[e-1],i=c-1;i>=1;--i)($=_[i])[e]=-u[i],$[e-1]=-t[i],($=_[--i])[e]=-u[i],$[e-1]=-t[i];0===i&&(($=_[0])[e]=-u[0],$[e-1]=-t[0])}if(0===e){for(t=n[0],i=c-1;i>=1;--i)_[i][0]=-t[i],_[--i][0]=-t[i];0===i&&(_[0][0]=-t[0])}return _},numeric._random=function r(n,e){var i,t,u=n[e],$=Array(u);if(e===n.length-1){for(t=Math.random,i=u-1;i>=1;i-=2)$[i]=t(),$[i-1]=t();return 0===i&&($[0]=t()),$}for(i=u-1;i>=0;i--)$[i]=r(n,e+1);return $},numeric.random=function r(n){return numeric._random(n,0)},numeric.norm2=function r(n){return Math.sqrt(numeric.norm2Squared(n))},numeric.linspace=function r(n,e,i){if(void 0===i&&(i=Math.max(Math.round(e-n)+1,1)),i<2)return 1===i?[n]:[];var t,u=Array(i);for(t=--i;t>=0;t--)u[t]=(t*e+(i-t)*n)/i;return u},numeric.getBlock=function r(n,e,i){var t=numeric.dim(n);function u(r,n){var $,o=e[n],c=i[n]-o,_=Array(c);if(n===t.length-1){for($=c;$>=0;$--)_[$]=r[$+o];return _}for($=c;$>=0;$--)_[$]=u(r[$+o],n+1);return _}return u(n,0)},numeric.setBlock=function r(n,e,i,t){var u=numeric.dim(n);function $(r,n,t){var o,c=e[t],_=i[t]-c;if(t===u.length-1)for(o=_;o>=0;o--)r[o+c]=n[o];for(o=_;o>=0;o--)$(r[o+c],n[o],t+1)}return $(n,t,0),n},numeric.getRange=function r(n,e,i){var t,u,$,o,c=e.length,_=i.length,f=Array(c);for(t=c-1;-1!==t;--t)for(f[t]=Array(_),$=f[t],o=n[e[t]],u=_-1;-1!==u;--u)$[u]=o[i[u]];return f},numeric.blockMatrix=function r(n){var e=numeric.dim(n);if(e.length<4)return numeric.blockMatrix([n]);var i,t,u,$,o,c=e[0],_=e[1];for(u=0,i=0,t=0;u<c;++u)i+=n[u][0].length;for($=0;$<_;++$)t+=n[0][$][0].length;var f=Array(i);for(u=0;u<i;++u)f[u]=Array(t);var m,s,a,x,h,l=0;for(u=0;u<c;++u){for(m=t,$=_-1;-1!==$;--$)for(m-=(o=n[u][$])[0].length,a=o.length-1;-1!==a;--a)for(h=o[a],s=f[l+a],x=h.length-1;-1!==x;--x)s[m+x]=h[x];l+=n[u][0].length}return f},numeric.tensor=function r(n,e){if("number"==typeof n||"number"==typeof e)return numeric.mul(n,e);var i=numeric.dim(n),t=numeric.dim(e);if(1!==i.length||1!==t.length)throw Error("numeric: tensor product is only defined for vectors");var u,$,o,c,_=i[0],f=t[0],m=Array(_);for($=_-1;$>=0;$--){for(u=Array(f),c=n[$],o=f-1;o>=3;--o)u[o]=c*e[o],u[--o]=c*e[o],u[--o]=c*e[o],u[--o]=c*e[o];for(;o>=0;)u[o]=c*e[o],--o;m[$]=u}return m},numeric.T=function r(n,e){this.x=n,this.y=e},numeric.t=function r(n,e){return new numeric.T(n,e)},numeric.Tbinop=function r(n,e,i,t,u){var $;if(numeric.indexOf,"string"!=typeof u)for($ in u="",numeric)numeric.hasOwnProperty($)&&(n.indexOf($)>=0||e.indexOf($)>=0||i.indexOf($)>=0||t.indexOf($)>=0)&&$.length>1&&(u+="var "+$+" = numeric."+$+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+u+"\nif(x.y) {  if(y.y) {    return new numeric.T("+t+");\n  }\n  return new numeric.T("+i+");\n}\nif(y.y) {\n  return new numeric.T("+e+");\n}\nreturn new numeric.T("+n+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function r(){var n=numeric.mul,e=numeric.div;if(this.y){var i=numeric.add(n(this.x,this.x),n(this.y,this.y));return new numeric.T(e(this.x,i),e(numeric.neg(this.y),i))}return new T(e(1,this.x))},numeric.T.prototype.div=function r(n){if(n instanceof numeric.T||(n=new numeric.T(n)),n.y)return this.mul(n.reciprocal());var r=numeric.div;return this.y?new numeric.T(r(this.x,n.x),r(this.y,n.x)):new numeric.T(r(this.x,n.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function r(){var n=numeric.transpose,e=this.x,i=this.y;return i?new numeric.T(n(e),n(i)):new numeric.T(n(e))},numeric.T.prototype.transjugate=function r(){var n=numeric.transpose,e=this.x,i=this.y;return i?new numeric.T(n(e),numeric.negtranspose(i)):new numeric.T(n(e))},numeric.Tunop=function r(n,e,i){return"string"!=typeof i&&(i=""),Function("var x = this;\n"+i+"\nif(x.y) {  "+e+";\n}\n"+n+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function r(){var n,e,i,t,u,$,o,c,_,f,m,s,a,x,h,l,p,g,v=this;if(void 0===v.y)return new numeric.T(numeric.inv(v.x));var _,f,m,d=v.x.length,y=numeric.identity(d),B=numeric.rep([d,d],0),D=numeric.clone(v.x),b=numeric.clone(v.y);for(_=0;_<d;_++){for(s=(x=D[_][_])*x+(h=b[_][_])*h,m=_,f=_+1;f<d;f++)(a=(x=D[f][_])*x+(h=b[f][_])*h)>s&&(m=f,s=a);for(m!==_&&(g=D[_],D[_]=D[m],D[m]=g,g=b[_],b[_]=b[m],b[m]=g,g=y[_],y[_]=y[m],y[m]=g,g=B[_],B[_]=B[m],B[m]=g),n=D[_],e=b[_],u=y[_],$=B[_],x=n[_],h=e[_],f=_+1;f<d;f++)l=n[f],p=e[f],n[f]=(l*x+p*h)/s,e[f]=(p*x-l*h)/s;for(f=0;f<d;f++)l=u[f],p=$[f],u[f]=(l*x+p*h)/s,$[f]=(p*x-l*h)/s;for(f=_+1;f<d;f++){for(i=D[f],t=b[f],o=y[f],c=B[f],x=i[_],h=t[_],m=_+1;m<d;m++)l=n[m],p=e[m],i[m]-=l*x-p*h,t[m]-=p*x+l*h;for(m=0;m<d;m++)l=u[m],p=$[m],o[m]-=l*x-p*h,c[m]-=p*x+l*h}}for(_=d-1;_>0;_--)for(u=y[_],$=B[_],f=_-1;f>=0;f--)for(o=y[f],c=B[f],x=D[f][_],h=b[f][_],m=d-1;m>=0;m--)l=u[m],p=$[m],o[m]-=x*l-h*p,c[m]-=x*p+h*l;return new numeric.T(y,B)},numeric.T.prototype.get=function r(n){var e,i=this.x,t=this.y,u=0,$=n.length;if(t){for(;u<$;)i=i[e=n[u]],t=t[e],u++;return new numeric.T(i,t)}for(;u<$;)i=i[e=n[u]],u++;return new numeric.T(i)},numeric.T.prototype.set=function r(n,e){var i,t=this.x,u=this.y,$=0,o=n.length,c=e.x,_=e.y;if(0===o)return _?this.y=_:u&&(this.y=void 0),this.x=t,this;if(_){for(u||(u=numeric.rep(numeric.dim(t),0),this.y=u);$<o-1;)t=t[i=n[$]],u=u[i],$++;return t[i=n[$]]=c,u[i]=_,this}if(u){for(;$<o-1;)t=t[i=n[$]],u=u[i],$++;return t[i=n[$]]=c,c instanceof Array?u[i]=numeric.rep(numeric.dim(c),0):u[i]=0,this}for(;$<o-1;)t=t[i=n[$]],$++;return t[i=n[$]]=c,this},numeric.T.prototype.getRows=function r(n,e){var i,t,u=e-n+1,$=Array(u),o=this.x,c=this.y;for(i=n;i<=e;i++)$[i-n]=o[i];if(c){for(t=Array(u),i=n;i<=e;i++)t[i-n]=c[i];return new numeric.T($,t)}return new numeric.T($)},numeric.T.prototype.setRows=function r(n,e,i){var t,u=this.x,$=this.y,o=i.x,c=i.y;for(t=n;t<=e;t++)u[t]=o[t-n];if(c)for($||($=numeric.rep(numeric.dim(u),0),this.y=$),t=n;t<=e;t++)$[t]=c[t-n];else if($)for(t=n;t<=e;t++)$[t]=numeric.rep([o[t-n].length],0);return this},numeric.T.prototype.getRow=function r(n){var e=this.x,i=this.y;return i?new numeric.T(e[n],i[n]):new numeric.T(e[n])},numeric.T.prototype.setRow=function r(n,e){var i=this.x,t=this.y,u=e.x,$=e.y;return i[n]=u,$?(t||(t=numeric.rep(numeric.dim(i),0),this.y=t),t[n]=$):t&&(t=numeric.rep([u.length],0)),this},numeric.T.prototype.getBlock=function r(n,e){var i=this.x,t=this.y,u=numeric.getBlock;return t?new numeric.T(u(i,n,e),u(t,n,e)):new numeric.T(u(i,n,e))},numeric.T.prototype.setBlock=function r(n,e,i){i instanceof numeric.T||(i=new numeric.T(i));var t=this.x,u=this.y,$=numeric.setBlock,o=i.x,c=i.y;if(c)return u||(this.y=numeric.rep(numeric.dim(this),0),u=this.y),$(t,n,e,o),$(u,n,e,c),this;$(t,n,e,o),u&&$(u,n,e,numeric.rep(numeric.dim(o),0))},numeric.T.rep=function r(n,e){var i=numeric.T;e instanceof i||(e=new i(e));var t=e.x,u=e.y,$=numeric.rep;return u?new i($(n,t),$(n,u)):new i($(n,t))},numeric.T.diag=function r(n){n instanceof numeric.T||(n=new numeric.T(n));var e=n.x,i=n.y,r=numeric.diag;return i?new numeric.T(r(e),r(i)):new numeric.T(r(e))},numeric.T.eig=function r(){if(this.y)throw Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function r(n){return new numeric.T(numeric.identity(n))},numeric.T.prototype.getDiag=function r(){var n=numeric,e=this.x,i=this.y;return i?new n.T(n.getDiag(e),n.getDiag(i)):new n.T(n.getDiag(e))},numeric.house=function r(n){var e=numeric.clone(n),i=(n[0]>=0?1:-1)*numeric.norm2(n);e[0]+=i;var t=numeric.norm2(e);if(0===t)throw Error("eig: internal error");return numeric.div(e,t)},numeric.toUpperHessenberg=function r(n){var e=numeric.dim(n);if(2!==e.length||e[0]!==e[1])throw Error("numeric: toUpperHessenberg() only works on square matrices");var i,t,u,$,o,c,_,f,m,s,a=e[0],x=numeric.clone(n),h=numeric.identity(a);for(t=0;t<a-2;t++){for($=Array(a-t-1),i=t+1;i<a;i++)$[i-t-1]=x[i][t];if(numeric.norm2($)>0){for(o=numeric.house($),c=numeric.getBlock(x,[t+1,t],[a-1,a-1]),_=numeric.tensor(o,numeric.dot(o,c)),i=t+1;i<a;i++)for(f=x[i],m=_[i-t-1],u=t;u<a;u++)f[u]-=2*m[u-t];for(i=0,c=numeric.getBlock(x,[0,t+1],[a-1,a-1]),_=numeric.tensor(numeric.dot(c,o),o);i<a;i++)for(f=x[i],m=_[i],u=t+1;u<a;u++)f[u]-=2*m[u-t-1];for(c=Array(a-t-1),i=t+1;i<a;i++)c[i-t-1]=h[i];for(_=numeric.tensor(o,numeric.dot(o,c)),i=t+1;i<a;i++)for(u=0,s=h[i],m=_[i-t-1];u<a;u++)s[u]-=2*m[u]}}return{H:x,Q:h}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(r,n){void 0===n&&(n=1e4),r=numeric.clone(r),numeric.clone(r);var e,i,t,u,$,o,c,_,f,m,s,a,x,h,l,p,g,v,d=numeric.dim(r)[0],y=numeric.identity(d);if(d<3)return{Q:y,B:[[0,d-1]]};var B=numeric.epsilon;for(v=0;v<n;v++){for(p=0;p<d-1;p++)if(Math.abs(r[p+1][p])<B*(Math.abs(r[p][p])+Math.abs(r[p+1][p+1]))){var D,b,w,F=numeric.QRFrancis(numeric.getBlock(r,[0,0],[p,p]),n),A=numeric.QRFrancis(numeric.getBlock(r,[p+1,p+1],[d-1,d-1]),n);for(l=0,a=Array(p+1);l<=p;l++)a[l]=y[l];for(l=0,x=numeric.dot(F.Q,a);l<=p;l++)y[l]=x[l];for(a=Array(d-p-1),l=p+1;l<d;l++)a[l-p-1]=y[l];for(x=numeric.dot(A.Q,a),l=p+1;l<d;l++)y[l]=x[l-p-1];return{Q:y,B:F.B.concat(numeric.add(A.B,p+1))}}for(t=r[d-2][d-2],u=r[d-2][d-1],$=r[d-1][d-2],_=t+(o=r[d-1][d-1]),c=t*o-u*$,f=numeric.getBlock(r,[0,0],[2,2]),_*_>=4*c?(D=.5*(_+Math.sqrt(_*_-4*c)),b=.5*(_-Math.sqrt(_*_-4*c)),f=numeric.add(numeric.sub(numeric.dot(f,f),numeric.mul(f,D+b)),numeric.diag(numeric.rep([3],D*b)))):f=numeric.add(numeric.sub(numeric.dot(f,f),numeric.mul(f,_)),numeric.diag(numeric.rep([3],c))),e=[f[0][0],f[1][0],f[2][0]],i=numeric.house(e),a=[r[0],r[1],r[2]],x=numeric.tensor(i,numeric.dot(i,a)),l=0;l<3;l++)for(g=0,s=r[l],h=x[l];g<d;g++)s[g]-=2*h[g];for(l=0,a=numeric.getBlock(r,[0,0],[d-1,2]),x=numeric.tensor(numeric.dot(a,i),i);l<d;l++)for(g=0,s=r[l],h=x[l];g<3;g++)s[g]-=2*h[g];for(l=0,a=[y[0],y[1],y[2]],x=numeric.tensor(i,numeric.dot(i,a));l<3;l++)for(g=0,m=y[l],h=x[l];g<d;g++)m[g]-=2*h[g];for(p=0;p<d-2;p++){for(g=p;g<=p+1;g++)if(Math.abs(r[g+1][g])<B*(Math.abs(r[g][g])+Math.abs(r[g+1][g+1]))){var F=numeric.QRFrancis(numeric.getBlock(r,[0,0],[g,g]),n),A=numeric.QRFrancis(numeric.getBlock(r,[g+1,g+1],[d-1,d-1]),n);for(l=0,a=Array(g+1);l<=g;l++)a[l]=y[l];for(l=0,x=numeric.dot(F.Q,a);l<=g;l++)y[l]=x[l];for(a=Array(d-g-1),l=g+1;l<d;l++)a[l-g-1]=y[l];for(x=numeric.dot(A.Q,a),l=g+1;l<d;l++)y[l]=x[l-g-1];return{Q:y,B:F.B.concat(numeric.add(A.B,g+1))}}for(e=Array((w=Math.min(d-1,p+3))-p),l=p+1;l<=w;l++)e[l-p-1]=r[l][p];for(i=numeric.house(e),a=numeric.getBlock(r,[p+1,p],[w,d-1]),x=numeric.tensor(i,numeric.dot(i,a)),l=p+1;l<=w;l++)for(s=r[l],h=x[l-p-1],g=p;g<d;g++)s[g]-=2*h[g-p];for(l=0,a=numeric.getBlock(r,[0,p+1],[d-1,w]),x=numeric.tensor(numeric.dot(a,i),i);l<d;l++)for(s=r[l],h=x[l],g=p+1;g<=w;g++)s[g]-=2*h[g-p-1];for(a=Array(w-p),l=p+1;l<=w;l++)a[l-p-1]=y[l];for(x=numeric.tensor(i,numeric.dot(i,a)),l=p+1;l<=w;l++)for(g=0,m=y[l],h=x[l-p-1];g<d;g++)m[g]-=2*h[g]}}throw Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function r(n,e){var i,t,u,$,o,c,_,f,m,s,a,x,h,l,p,g,v,d=numeric.toUpperHessenberg(n),y=numeric.QRFrancis(d.H,e),B=numeric.T,D=n.length,b=y.B,w=numeric.dot(y.Q,numeric.dot(d.H,numeric.transpose(y.Q))),F=new B(numeric.dot(y.Q,d.Q)),A=b.length,C=Math.sqrt;for(p=0;p<A;p++)if((l=b[p][0])===b[p][1]);else{if(v=l+1,i=w[l][l],t=w[l][v],u=w[v][l],$=w[v][v],0===t&&0===u)continue;(_=(o=-i-$)*o-4*(c=i*$-t*u))>=0?((x=(i-(f=o<0?-.5*(o-C(_)):-.5*(o+C(_))))*(i-f)+t*t)>(h=u*u+($-f)*($-f))?(s=(i-f)/(x=C(x)),a=t/x):(s=u/(h=C(h)),a=($-f)/h),g=new B([[a,-s],[s,a]]),F.setRows(l,v,g.dot(F.getRows(l,v)))):(f=-.5*o,m=.5*C(-_),(x=(i-f)*(i-f)+t*t)>(h=u*u+($-f)*($-f))?(s=(i-f)/(x=C(x+m*m)),a=t/x,f=0,m/=x):(s=u/(h=C(h+m*m)),a=($-f)/h,f=m/h,m=0),g=new B([[a,-s],[s,a]],[[f,m],[m,-f]]),F.setRows(l,v,g.dot(F.getRows(l,v))))}var E=F.dot(n).dot(F.transjugate()),D=n.length,k=numeric.T.identity(D);for(v=0;v<D;v++)if(v>0)for(p=v-1;p>=0;p--){var j=E.get([p,p]),S=E.get([v,v]);if(numeric.neq(j.x,S.x)||numeric.neq(j.y,S.y))f=E.getRow(p).getBlock([p],[v-1]),m=k.getRow(v).getBlock([p],[v-1]),k.set([v,p],E.get([p,v]).neg().sub(f.dot(m)).div(j.sub(S)));else{k.setRow(v,k.getRow(p));continue}}for(v=0;v<D;v++)f=k.getRow(v),k.setRow(v,f.div(f.norm2()));return k=k.transpose(),k=F.transjugate().dot(k),{lambda:E.getDiag(),E:k}},numeric.ccsSparse=function r(n){var e,i,t,u,$=n.length,o=[];for(t=$-1;-1!==t;--t)for(u in i=n[t]){for(u=parseInt(u);u>=o.length;)o[o.length]=0;0!==i[u]&&o[u]++}var e=o.length,c=Array(e+1);for(t=0,c[0]=0;t<e;++t)c[t+1]=c[t]+o[t];var _=Array(c[e]),f=Array(c[e]);for(t=$-1;-1!==t;--t)for(u in i=n[t])0!==i[u]&&(o[u]--,_[c[u]+o[u]]=t,f[c[u]+o[u]]=i[u]);return[c,_,f]},numeric.ccsFull=function r(n){var e,i,t,u,$=n[0],o=n[1],c=n[2],_=numeric.ccsDim(n),f=_[0],m=_[1],s=numeric.rep([f,m],0);for(e=0;e<m;e++)for(t=$[e],u=$[e+1],i=t;i<u;++i)s[o[i]][e]=c[i];return s},numeric.ccsTSolve=function r(n,e,i,t,u){var $,o,c,_,f,m,s,a=n[0],x=n[1],h=n[2],l=a.length-1,p=Math.max,g=0;function v(r){var n;if(0===i[r]){for(i[r]=1,n=a[r];n<a[r+1];++n)v(x[n]);u[g]=r,++g}}for(void 0===t&&(i=numeric.rep([l],0)),void 0===t&&(t=numeric.linspace(0,i.length-1)),void 0===u&&(u=[]),$=t.length-1;-1!==$;--$)v(t[$]);for(u.length=g,$=u.length-1;-1!==$;--$)i[u[$]]=0;for($=t.length-1;-1!==$;--$)i[o=t[$]]=e[o];for($=u.length-1;-1!==$;--$){for(c=a[o=u[$]],_=p(a[o+1],c),f=c;f!==_;++f)if(x[f]===o){i[o]/=h[f];break}for(s=i[o],f=c;f!==_;++f)(m=x[f])!==o&&(i[m]-=s*h[f])}return i},numeric.ccsDFS=function r(n){this.k=Array(n),this.k1=Array(n),this.j=Array(n)},numeric.ccsDFS.prototype.dfs=function r(n,e,i,t,u,$){var o,c,_,f=0,m=u.length,s=this.k,a=this.k1,x=this.j;if(0===t[n])for(t[n]=1,x[0]=n,s[0]=c=e[n],a[0]=_=e[n+1];;)if(c>=_){if(u[m]=x[f],0===f)return;++m,c=s[--f],_=a[f]}else 0===t[o=$[i[c]]]?(t[o]=1,s[f]=c,x[++f]=o,c=e[o],a[f]=_=e[o+1]):++c},numeric.ccsLPSolve=function r(n,e,i,t,u,$,o){var c,_,f,m,s,a,x,h,l,p=n[0],g=n[1],v=n[2];p.length;var d=e[0],y=e[1],B=e[2];for(_=d[u],f=d[u+1],t.length=0,c=_;c<f;++c)o.dfs($[y[c]],p,g,i,t,$);for(c=t.length-1;-1!==c;--c)i[t[c]]=0;for(c=_;c!==f;++c)i[m=$[y[c]]]=B[c];for(c=t.length-1;-1!==c;--c){for(s=p[m=t[c]],a=p[m+1],x=s;x<a;++x)if($[g[x]]===m){i[m]/=v[x];break}for(l=i[m],x=s;x<a;++x)(h=$[g[x]])!==m&&(i[h]-=l*v[x])}return i},numeric.ccsLUP1=function r(n,e){var i,t,u,$,o,c,_,f=n[0].length-1,m=[numeric.rep([f+1],0),[],[]],s=[numeric.rep([f+1],0),[],[]],a=m[0],x=m[1],h=m[2],l=s[0],p=s[1],g=s[2],v=numeric.rep([f],0),d=numeric.rep([f],0),y=numeric.ccsLPSolve,B=Math.abs,D=numeric.linspace(0,f-1),b=numeric.linspace(0,f-1),w=new numeric.ccsDFS(f);for(void 0===e&&(e=1),i=0;i<f;++i){for(y(m,n,v,d,i,b,w),$=-1,o=-1,t=d.length-1;-1!==t;--t)!((u=d[t])<=i)&&(c=B(v[u]))>$&&(o=u,$=c);for(B(v[i])<e*$&&(t=D[i],$=D[o],D[i]=$,b[$]=i,D[o]=t,b[t]=o,$=v[i],v[i]=v[o],v[o]=$),$=a[i],o=l[i],_=v[i],x[$]=D[i],h[$]=1,++$,t=d.length-1;-1!==t;--t)c=v[u=d[t]],d[t]=0,v[u]=0,u<=i?(p[o]=u,g[o]=c,++o):(x[$]=D[u],h[$]=c/_,++$);a[i+1]=$,l[i+1]=o}for(t=x.length-1;-1!==t;--t)x[t]=b[x[t]];return{L:m,U:s,P:D,Pinv:b}},numeric.ccsDFS0=function r(n){this.k=Array(n),this.k1=Array(n),this.j=Array(n)},numeric.ccsDFS0.prototype.dfs=function r(n,e,i,t,u,$,o){var c,_,f,m=0,s=u.length,a=this.k,x=this.k1,h=this.j;if(0===t[n])for(t[n]=1,h[0]=n,a[0]=_=e[$[n]],x[0]=f=e[$[n]+1];;){if(isNaN(_))throw Error("Ow!");if(_>=f){if(u[s]=$[h[m]],0===m)return;++s,_=a[--m],f=x[m]}else 0===t[c=i[_]]?(t[c]=1,a[m]=_,h[++m]=c,_=e[c=$[c]],x[m]=f=e[c+1]):++_}},numeric.ccsLPSolve0=function r(n,e,i,t,u,$,o,c){var _,f,m,s,a,x,h,l,p,g=n[0],v=n[1],d=n[2];g.length;var y=e[0],B=e[1],D=e[2];for(f=y[u],m=y[u+1],t.length=0,_=f;_<m;++_)c.dfs(B[_],g,v,i,t,$,o);for(_=t.length-1;-1!==_;--_)i[o[s=t[_]]]=0;for(_=f;_!==m;++_)i[s=B[_]]=D[_];for(_=t.length-1;-1!==_;--_){for(l=o[s=t[_]],a=g[s],x=g[s+1],h=a;h<x;++h)if(v[h]===l){i[l]/=d[h];break}for(p=i[l],h=a;h<x;++h)i[v[h]]-=p*d[h];i[l]=p}},numeric.ccsLUP0=function r(n,e){var i,t,u,$,o,c,_,f=n[0].length-1,m=[numeric.rep([f+1],0),[],[]],s=[numeric.rep([f+1],0),[],[]],a=m[0],x=m[1],h=m[2],l=s[0],p=s[1],g=s[2],v=numeric.rep([f],0),d=numeric.rep([f],0),y=numeric.ccsLPSolve0,B=Math.abs,D=numeric.linspace(0,f-1),b=numeric.linspace(0,f-1),w=new numeric.ccsDFS0(f);for(void 0===e&&(e=1),i=0;i<f;++i){for(y(m,n,v,d,i,b,D,w),$=-1,o=-1,t=d.length-1;-1!==t;--t)!((u=d[t])<=i)&&(c=B(v[D[u]]))>$&&(o=u,$=c);for(B(v[D[i]])<e*$&&(t=D[i],$=D[o],D[i]=$,b[$]=i,D[o]=t,b[t]=o),$=a[i],o=l[i],_=v[D[i]],x[$]=D[i],h[$]=1,++$,t=d.length-1;-1!==t;--t)c=v[D[u=d[t]]],d[t]=0,v[D[u]]=0,u<=i?(p[o]=u,g[o]=c,++o):(x[$]=D[u],h[$]=c/_,++$);a[i+1]=$,l[i+1]=o}for(t=x.length-1;-1!==t;--t)x[t]=b[x[t]];return{L:m,U:s,P:D,Pinv:b}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function r(n){return[numeric.sup(n[1])+1,n[0].length-1]},numeric.ccsGetBlock=function r(n,e,i){var t=numeric.ccsDim(n),u=t[0],$=t[1];void 0===e?e=numeric.linspace(0,u-1):"number"==typeof e&&(e=[e]),void 0===i?i=numeric.linspace(0,$-1):"number"==typeof i&&(i=[i]);var o,c,_,f,m,s=e.length,a=i.length,x=numeric.rep([$],0),h=[],l=[],p=[x,h,l],g=n[0],v=n[1],d=n[2],y=numeric.rep([u],0),B=0,D=numeric.rep([u],0);for(c=0;c<a;++c){var b=g[f=i[c]],w=g[f+1];for(o=b;o<w;++o)D[_=v[o]]=1,y[_]=d[o];for(o=0;o<s;++o)D[m=e[o]]&&(h[B]=o,l[B]=y[e[o]],++B);for(o=b;o<w;++o)D[_=v[o]]=0;x[c+1]=B}return p},numeric.ccsDot=function r(n,e){var i,t,u,$,o,c,_,f,m,s,a,x=n[0],h=n[1],l=n[2],p=e[0],g=e[1],v=e[2],d=numeric.ccsDim(n),y=numeric.ccsDim(e),B=d[0],D=(d[1],y[1]),b=numeric.rep([B],0),w=numeric.rep([B],0),F=Array(B),A=numeric.rep([D],0),C=[],E=[],k=[A,C,E];for(u=0;u!==D;++u){for($=p[u],o=p[u+1],m=0,t=$;t<o;++t)for(s=g[t],a=v[t],c=x[s],_=x[s+1],i=c;i<_;++i)0===w[f=h[i]]&&(F[m]=f,w[f]=1,m+=1),b[f]=b[f]+l[i]*a;for(o=($=A[u])+m,A[u+1]=o,t=m-1;-1!==t;--t)a=$+t,i=F[t],C[a]=i,E[a]=b[i],w[i]=0,b[i]=0;A[u+1]=A[u]+m}return k},numeric.ccsLUPSolve=function r(n,e){var i=n.L,t=n.U;n.P;var u=e[0],$=!1;"object"!=typeof u&&(u=(e=[[0,e.length],numeric.linspace(0,e.length-1),e])[0],$=!0);var o,c,_,f,m,s,a=e[1],x=e[2],h=i[0].length-1,l=u.length-1,p=numeric.rep([h],0),g=Array(h),v=numeric.rep([h],0),d=Array(h),y=numeric.rep([l+1],0),B=[],D=[],b=numeric.ccsTSolve,w=0;for(o=0;o<l;++o){for(m=0,_=u[o],f=u[o+1],c=_;c<f;++c)s=n.Pinv[a[c]],d[m]=s,v[s]=x[c],++m;for(d.length=m,b(i,v,p,d,g),c=d.length-1;-1!==c;--c)v[d[c]]=0;if(b(t,p,v,g,d),$)return v;for(c=g.length-1;-1!==c;--c)p[g[c]]=0;for(c=d.length-1;-1!==c;--c)s=d[c],B[w]=s,D[w]=v[s],v[s]=0,++w;y[o+1]=w}return[y,B,D]},numeric.ccsbinop=function r(n,e){return void 0===e&&(e=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+e+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+n+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function r(n){var e,i=n[0],t=n[1],u=n[2],$=numeric.sup(t)+1,o=i.length,c=numeric.rep([$],0),_=Array(o),f=Array(o),m=numeric.rep([$],0);for(e=0;e<o;++e)m[t[e]]++;for(e=0;e<$;++e)c[e+1]=c[e]+m[e];var s,a,x=c.slice(0);for(e=0;e<o;++e)_[s=x[a=t[e]]]=i[e],f[s]=u[e],x[a]=x[a]+1;return[c,_,f]},numeric.ccsGather=function r(n){var e,i,t,u,$,o=n[0],c=n[1],_=n[2],f=o.length-1,m=c.length,s=Array(m),a=Array(m),x=Array(m);for(e=0,$=0;e<f;++e)for(t=o[e],u=o[e+1],i=t;i!==u;++i)a[$]=e,s[$]=c[i],x[$]=_[i],++$;return[s,a,x]},numeric.sdim=function r(n,e,i){var t;if(void 0===e&&(e=[]),"object"!=typeof n)return e;for(t in void 0===i&&(i=0),i in e||(e[i]=0),n.length>e[i]&&(e[i]=n.length),n)n.hasOwnProperty(t)&&r(n[t],e,i+1);return e},numeric.sclone=function r(n,e,i){void 0===e&&(e=0),void 0===i&&(i=numeric.sdim(n).length);var t,u=Array(n.length);if(e===i-1){for(t in n)n.hasOwnProperty(t)&&(u[t]=n[t]);return u}for(t in n)n.hasOwnProperty(t)&&(u[t]=r(n[t],e+1,i));return u},numeric.sdiag=function r(n){var e,i,t=n.length,u=Array(t);for(e=t-1;e>=1;e-=2)i=e-1,u[e]=[],u[e][e]=n[e],u[i]=[],u[i][i]=n[i];return 0===e&&(u[0]=[],u[0][0]=n[e]),u},numeric.sidentity=function r(n){return numeric.sdiag(numeric.rep([n],1))},numeric.stranspose=function r(n){var e,i,t,u=[];for(e in n.length,n)if(n.hasOwnProperty(e))for(i in t=n[e])t.hasOwnProperty(i)&&("object"!=typeof u[i]&&(u[i]=[]),u[i][e]=t[i]);return u},numeric.sLUP=function r(n,e){throw Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function r(n,e){var i,t,u,$,o,c,_,f=n.length,m=(e.length,numeric.stranspose(e)),s=m.length,a=Array(f);for(u=f-1;u>=0;u--){for(_=[],i=n[u],o=s-1;o>=0;o--){for($ in c=0,t=m[o],i)i.hasOwnProperty($)&&$ in t&&(c+=i[$]*t[$]);c&&(_[o]=c)}a[u]=_}return a},numeric.sdotMV=function r(n,e){var i,t,u,$,o=n.length,c=Array(o);for(t=o-1;t>=0;t--){for(u in i=n[t],$=0,i)i.hasOwnProperty(u)&&e[u]&&($+=i[u]*e[u]);$&&(c[t]=$)}return c},numeric.sdotVM=function r(n,e){var i,t,u,$,o=[];for(i in n)if(n.hasOwnProperty(i))for(t in u=e[i],$=n[i],u)u.hasOwnProperty(t)&&(o[t]||(o[t]=0),o[t]+=$*u[t]);return o},numeric.sdotVV=function r(n,e){var i,t=0;for(i in n)n[i]&&e[i]&&(t+=n[i]*e[i]);return t},numeric.sdot=function r(n,e){var i=numeric.sdim(n).length,t=numeric.sdim(e).length,u=1e3*i+t;switch(u){case 0:return n*e;case 1001:return numeric.sdotVV(n,e);case 2001:return numeric.sdotMV(n,e);case 1002:return numeric.sdotVM(n,e);case 2002:return numeric.sdotMM(n,e);default:throw Error("numeric.sdot not implemented for tensors of order "+i+" and "+t)}},numeric.sscatter=function r(n){var e,i,t,u,$=n[0].length,o=n.length,c=[];for(i=$-1;i>=0;--i)if(n[o-1][i]){for(t=0,u=c;t<o-2;t++)u[e=n[t][i]]||(u[e]=[]),u=u[e];u[n[t][i]]=n[t+1][i]}return c},numeric.sgather=function r(n,e,i){var t,u,$;for(u in void 0===e&&(e=[]),void 0===i&&(i=[]),t=i.length,n)if(n.hasOwnProperty(u)){if(i[t]=parseInt(u),"number"==typeof($=n[u])){if($){if(0===e.length)for(u=t+1;u>=0;--u)e[u]=[];for(u=t;u>=0;--u)e[u].push(i[u]);e[t+1].push($)}}else r($,e,i)}return i.length>t&&i.pop(),e},numeric.cLU=function r(n){var e,i,t,u,$,o,c,_,f,m,s,a,x=n[0],h=n[1],l=n[2],u=x.length,p=0;for(c=0;c<u;c++)x[c]>p&&(p=x[c]);var g=Array(++p),v=Array(p),d=numeric.rep([p],1/0),y=numeric.rep([p],-1/0);for(f=0;f<u;f++)c=x[f],(_=h[f])<d[c]&&(d[c]=_),_>y[c]&&(y[c]=_);for(c=0;c<p-1;c++)y[c]>y[c+1]&&(y[c+1]=y[c]);for(c=p-1;c>=1;c--)d[c]<d[c-1]&&(d[c-1]=d[c]);var B=0,D=0;for(c=0;c<p;c++)v[c]=numeric.rep([y[c]-d[c]+1],0),g[c]=numeric.rep([c-d[c]],0),B+=c-d[c]+1,D+=y[c]-c+1;for(f=0;f<u;f++)v[c=x[f]][h[f]-d[c]]=l[f];for(c=0;c<p-1;c++)for(m=c-d[c],e=v[c],_=c+1;d[_]<=c&&_<p;_++)if(s=c-d[_],a=y[c]-c,t=(i=v[_])[s]/e[m]){for(f=1;f<=a;f++)i[f+s]-=t*e[f+m];g[_][c-d[_]]=t}var e=[],i=[],b=[],w=[],F=[],A=[];for(c=0,u=0,$=0;c<p;c++){for(m=d[c],s=y[c],o=v[c],_=c;_<=s;_++)o[_-m]&&(e[u]=c,i[u]=_,b[u]=o[_-m],u++);for(o=g[c],_=m;_<c;_++)o[_-m]&&(w[$]=c,F[$]=_,A[$]=o[_-m],$++);w[$]=c,F[$]=c,A[$]=1,$++}return{U:[e,i,b],L:[w,F,A]}},numeric.cLUsolve=function r(n,e){var i=n.L,t=n.U,u=numeric.clone(e),$=i[0],o=i[1],c=i[2],_=t[0],f=t[1],m=t[2],s=_.length;$.length;var a,x,h=u.length;for(a=0,x=0;a<h;a++){for(;o[x]<a;)u[a]-=c[x]*u[o[x]],x++;x++}for(x=s-1,a=h-1;a>=0;a--){for(;f[x]>a;)u[a]-=m[x]*u[f[x]],x--;u[a]/=m[x],x--}return u},numeric.cgrid=function r(n,e){"number"==typeof n&&(n=[n,n]);var i,t,u,$=numeric.rep(n,-1);for("function"!=typeof e&&(e="L"===e?function(r,e){return r>=n[0]/2||e<n[1]/2}:function(r,n){return!0}),u=0,i=1;i<n[0]-1;i++)for(t=1;t<n[1]-1;t++)e(i,t)&&($[i][t]=u,u++);return $},numeric.cdelsq=function r(n){var e,i,t,u,$,o=[[-1,0],[0,-1],[0,1],[1,0]],c=numeric.dim(n),_=c[0],f=c[1],m=[],s=[],a=[];for(e=1;e<_-1;e++)for(i=1;i<f-1;i++)if(!(n[e][i]<0)){for(t=0;t<4;t++)u=e+o[t][0],$=i+o[t][1],n[u][$]<0||(m.push(n[e][i]),s.push(n[u][$]),a.push(-1));m.push(n[e][i]),s.push(n[e][i]),a.push(4)}return[m,s,a]},numeric.cdotMV=function r(n,e){var i,t,u,$=n[0],o=n[1],c=n[2],_=$.length;for(t=0,u=0;t<_;t++)$[t]>u&&(u=$[t]);for(u++,i=numeric.rep([u],0),t=0;t<_;t++)i[$[t]]+=c[t]*e[o[t]];return i},numeric.Spline=function r(n,e,i,t,u){this.x=n,this.yl=e,this.yr=i,this.kl=t,this.kr=u},numeric.Spline.prototype._at=function r(n,e){var n,i,t,u,$=this.x,o=this.yl,c=this.yr,_=this.kl,f=this.kr,m=numeric.add,s=numeric.sub,a=numeric.mul;i=s(a(_[e],$[e+1]-$[e]),s(c[e+1],o[e])),t=m(a(f[e+1],$[e]-$[e+1]),s(c[e+1],o[e]));var x=(u=(n-$[e])/($[e+1]-$[e]))*(1-u);return m(m(m(a(1-u,o[e]),a(u,c[e+1])),a(i,x*(1-u))),a(t,x*u))},numeric.Spline.prototype.at=function r(n){if("number"==typeof n){var e,i,t,u=this.x,$=u.length,o=Math.floor;for(e=0,i=$-1;i-e>1;)u[t=o((e+i)/2)]<=n?e=t:i=t;return this._at(n,e)}var c,$=n.length,_=Array($);for(c=$-1;-1!==c;--c)_[c]=this.at(n[c]);return _},numeric.Spline.prototype.diff=function r(){var n,e,i,t=this.x,u=this.yl,$=this.yr,o=this.kl,c=this.kr,_=u.length,f=o,m=c,s=Array(_),a=Array(_),x=numeric.add,h=numeric.mul,l=numeric.div,p=numeric.sub;for(n=_-1;-1!==n;--n)e=t[n+1]-t[n],i=p($[n+1],u[n]),s[n]=l(x(h(i,6),h(o[n],-4*e),h(c[n+1],-2*e)),e*e),a[n+1]=l(x(h(i,-6),h(o[n],2*e),h(c[n+1],4*e)),e*e);return new numeric.Spline(t,f,m,s,a)},numeric.Spline.prototype.roots=function r(){function n(r){return r*r}function e(r,n,e,i,t){var u=2*e-(n-r),$=-(2*i)+(n-r),o=(t+1)*.5,c=o*(1-o);return(1-o)*r+o*n+u*c*(1-o)+$*c*o}var i=[],t=this.x,u=this.yl,$=this.yr,o=this.kl,c=this.kr;"number"==typeof u[0]&&(u=[u],$=[$],o=[o],c=[c]);var _,f,m,s,a,x,h,l,p,g,v,d,y,B,D,b,w,F,A,C,E,k,j,S,V=u.length,P=t.length-1,i=Array(V),q=Math.sqrt;for(_=0;_!==V;++_){for(f=0,s=u[_],a=$[_],x=o[_],h=c[_],l=[];f!==P;f++){for(f>0&&a[f]*s[f]<0&&l.push(t[f]),b=t[f+1]-t[f],w=t[f],v=s[f],d=a[f+1],D=n((p=x[f]/b)-(g=h[f+1]/b)+3*(v-d))+12*g*v,y=g+3*v+2*p-3*d,B=3*(g+p+2*(v-d)),D<=0?F=(A=y/B)>t[f]&&A<t[f+1]?[t[f],A,t[f+1]]:[t[f],t[f+1]]:(A=(y-q(D))/B,C=(y+q(D))/B,F=[t[f]],A>t[f]&&A<t[f+1]&&F.push(A),C>t[f]&&C<t[f+1]&&F.push(C),F.push(t[f+1])),k=F[0],A=this._at(k,f),m=0;m<F.length-1;m++){if(j=F[m+1],C=this._at(j,f),0===A){l.push(k),k=j,A=C;continue}if(0===C||A*C>0){k=j,A=C;continue}for(var L=0;!((S=(A*j-C*k)/(A-C))<=k)&&!(S>=j);)if((E=this._at(S,f))*C>0)j=S,C=E,-1===L&&(A*=.5),L=-1;else if(E*A>0)k=S,A=E,1===L&&(C*=.5),L=1;else break;l.push(S),k=F[m+1],A=this._at(k,f)}0===C&&l.push(j)}i[_]=l}return"number"==typeof this.yl[0]?i[0]:i},numeric.spline=function r(n,e,i,t){var u,$=n.length,o=[],c=[],_=[],f=numeric.sub,m=numeric.mul,s=numeric.add;for(u=$-2;u>=0;u--)c[u]=n[u+1]-n[u],_[u]=f(e[u+1],e[u]);("string"==typeof i||"string"==typeof t)&&(i=t="periodic");var a=[[],[],[]];switch(typeof i){case"undefined":o[0]=m(3/(c[0]*c[0]),_[0]),a[0].push(0,0),a[1].push(0,1),a[2].push(2/c[0],1/c[0]);break;case"string":o[0]=s(m(3/(c[$-2]*c[$-2]),_[$-2]),m(3/(c[0]*c[0]),_[0])),a[0].push(0,0,0),a[1].push($-2,0,1),a[2].push(1/c[$-2],2/c[$-2]+2/c[0],1/c[0]);break;default:o[0]=i,a[0].push(0),a[1].push(0),a[2].push(1)}for(u=1;u<$-1;u++)o[u]=s(m(3/(c[u-1]*c[u-1]),_[u-1]),m(3/(c[u]*c[u]),_[u])),a[0].push(u,u,u),a[1].push(u-1,u,u+1),a[2].push(1/c[u-1],2/c[u-1]+2/c[u],1/c[u]);switch(typeof t){case"undefined":o[$-1]=m(3/(c[$-2]*c[$-2]),_[$-2]),a[0].push($-1,$-1),a[1].push($-2,$-1),a[2].push(1/c[$-2],2/c[$-2]);break;case"string":a[1][a[1].length-1]=0;break;default:o[$-1]=t,a[0].push($-1),a[1].push($-1),a[2].push(1)}var x=Array((o="number"!=typeof o[0]?numeric.transpose(o):[o]).length);if("string"==typeof i)for(u=x.length-1;-1!==u;--u)x[u]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(a)),o[u]),x[u][$-1]=x[u][0];else for(u=x.length-1;-1!==u;--u)x[u]=numeric.cLUsolve(numeric.cLU(a),o[u]);return x="number"==typeof e[0]?x[0]:numeric.transpose(x),new numeric.Spline(n,e,e,x,x)},numeric.fftpow2=function r(n,e){var i=n.length;if(1!==i){var t,u,$=Math.cos,o=Math.sin,c=Array(i/2),_=Array(i/2),f=Array(i/2),m=Array(i/2);for(u=i/2,t=i-1;-1!==t;--t)f[--u]=n[t],m[u]=e[t],--t,c[u]=n[t],_[u]=e[t];r(c,_),r(f,m),u=i/2;var s,a,x,h=-6.283185307179586/i;for(t=i-1;-1!==t;--t)-1==--u&&(u=i/2-1),a=$(s=h*t),x=o(s),n[t]=c[u]+a*f[u]-x*m[u],e[t]=_[u]+a*m[u]+x*f[u]}},numeric._ifftpow2=function r(n,e){var i=n.length;if(1!==i){var t,u,$=Math.cos,o=Math.sin,c=Array(i/2),_=Array(i/2),f=Array(i/2),m=Array(i/2);for(u=i/2,t=i-1;-1!==t;--t)f[--u]=n[t],m[u]=e[t],--t,c[u]=n[t],_[u]=e[t];r(c,_),r(f,m),u=i/2;var s,a,x,h=6.283185307179586/i;for(t=i-1;-1!==t;--t)-1==--u&&(u=i/2-1),a=$(s=h*t),x=o(s),n[t]=c[u]+a*f[u]-x*m[u],e[t]=_[u]+a*m[u]+x*f[u]}},numeric.ifftpow2=function r(n,e){numeric._ifftpow2(n,e),numeric.diveq(n,n.length),numeric.diveq(e,e.length)},numeric.convpow2=function r(n,e,i,t){numeric.fftpow2(n,e),numeric.fftpow2(i,t);var u,$,o,c,_,f=n.length;for(u=f-1;-1!==u;--u)$=n[u],c=e[u],o=i[u],_=t[u],n[u]=$*o-c*_,e[u]=$*_+c*o;numeric.ifftpow2(n,e)},numeric.T.prototype.fft=function r(){var n,e,i=this.x,t=this.y,u=i.length,$=Math.log,o=$(2),c=Math.pow(2,Math.ceil($(2*u-1)/o)),_=numeric.rep([c],0),f=numeric.rep([c],0),m=Math.cos,s=Math.sin,a=-3.141592653589793/u,x=numeric.rep([c],0),h=numeric.rep([c],0);for(n=0;n<u;n++)x[n]=i[n];if(void 0!==t)for(n=0;n<u;n++)h[n]=t[n];for(n=1,_[0]=1;n<=c/2;n++)e=a*n*n,_[n]=m(e),f[n]=s(e),_[c-n]=m(e),f[c-n]=s(e);var l=new numeric.T(x,h),p=new numeric.T(_,f);return l=l.mul(p),numeric.convpow2(l.x,l.y,numeric.clone(p.x),numeric.neg(p.y)),(l=l.mul(p)).x.length=u,l.y.length=u,l},numeric.T.prototype.ifft=function r(){var n,e,i=this.x,t=this.y,u=i.length,$=Math.log,o=$(2),c=Math.pow(2,Math.ceil($(2*u-1)/o)),_=numeric.rep([c],0),f=numeric.rep([c],0),m=Math.cos,s=Math.sin,a=3.141592653589793/u,x=numeric.rep([c],0),h=numeric.rep([c],0);for(n=0;n<u;n++)x[n]=i[n];if(void 0!==t)for(n=0;n<u;n++)h[n]=t[n];for(n=1,_[0]=1;n<=c/2;n++)e=a*n*n,_[n]=m(e),f[n]=s(e),_[c-n]=m(e),f[c-n]=s(e);var l=new numeric.T(x,h),p=new numeric.T(_,f);return l=l.mul(p),numeric.convpow2(l.x,l.y,numeric.clone(p.x),numeric.neg(p.y)),(l=l.mul(p)).x.length=u,l.y.length=u,l.div(u)},numeric.gradient=function r(n,e){var i=e.length,t=n(e);if(isNaN(t))throw Error("gradient: f(x) is a NaN!");var u,$,o,c=Math.max,_=numeric.clone(e),f=Array(i);numeric.div,numeric.sub;var m,s,a,x,h,l,p,c=Math.max,g=.001,v=Math.abs,d=Math.min,y=0;for(u=0;u<i;u++)for(var B=c(1e-6*t,1e-8);;){if(++y>20)throw Error("Numerical gradient fails");if(_[u]=e[u]+B,$=n(_),_[u]=e[u]-B,o=n(_),_[u]=e[u],isNaN($)||isNaN(o)){B/=16;continue}if(f[u]=($-o)/(2*B),s=e[u]-B,a=e[u],x=e[u]+B,h=($-t)/B,l=(t-o)/B,p=c(v(f[u]),v(t),v($),v(o),v(s),v(a),v(x),1e-8),(m=d(c(v(h-f[u]),v(l-f[u]),v(h-l))/p,B/p))>g)B/=16;else break}return f},numeric.uncmin=function r(n,e,i,t,u,$,o){var c=numeric.gradient;void 0===o&&(o={}),void 0===i&&(i=1e-8),void 0===t&&(t=function(r){return c(n,r)}),void 0===u&&(u=1e3);var _,f,m=(e=numeric.clone(e)).length,s=n(e);if(isNaN(s))throw Error("uncmin: f(x0) is a NaN!");var a=Math.max,x=numeric.norm2;i=a(i,numeric.epsilon);var h,l,p,g,v,d,y,B,D,b,w=o.Hinv||numeric.identity(m),F=numeric.dot,A=(numeric.inv,numeric.sub),C=numeric.add,E=numeric.tensor,k=numeric.div,j=numeric.mul,S=numeric.all,V=numeric.isFinite,P=numeric.neg,q=0,L="";for(l=t(e);q<u;){if("function"==typeof $&&$(q,e,s,l,w)){L="Callback returned true";break}if(!S(V(l))){L="Gradient has Infinity or NaN";break}if(!S(V(h=P(F(w,l))))){L="Search direction has Infinity or NaN";break}if((b=x(h))<i){L="Newton step smaller than tol";break}for(D=1,f=F(l,h),v=e;q<u&&!(D*b<i);){if(v=C(e,g=j(h,D)),(_=n(v))-s>=.1*D*f||isNaN(_)){D*=.5,++q;continue}break}if(D*b<i){L="Line search step size smaller than tol";break}if(q===u){L="maxit reached during line search";break}B=F(d=A(p=t(v),l),g),y=F(w,d),w=A(C(w,j((B+F(d,y))/(B*B),E(g,g))),k(C(E(y,g),E(g,y)),B)),e=v,s=_,l=p,++q}return{solution:e,f:s,gradient:l,invHessian:w,iterations:q,message:L}},numeric.Dopri=function r(n,e,i,t,u,$,o){this.x=n,this.y=e,this.f=i,this.ymid=t,this.iterations=u,this.events=o,this.message=$},numeric.Dopri.prototype._at=function r(n,e){function i(r){return r*r}var t,u,$,o,c,_,n,f,m=this,s=m.x,a=m.y,x=m.f,h=m.ymid;s.length;var l,p,g,v=.5,d=numeric.add,y=numeric.mul,B=numeric.sub;return t=s[e],u=s[e+1],o=a[e],c=a[e+1],f=u-t,$=t+v*f,_=h[e],l=B(x[e],y(o,1/(t-$)+2/(t-u))),p=B(x[e+1],y(c,1/(u-$)+2/(u-t))),d(d(d(d(y(o,(g=[i(n-u)*(n-$)/i(t-u)/(t-$),i(n-t)*i(n-u)/i(t-$)/i(u-$),i(n-t)*(n-$)/i(u-t)/(u-$),(n-t)*i(n-u)*(n-$)/i(t-u)/(t-$),(n-u)*i(n-t)*(n-$)/i(t-u)/(u-$)])[0]),y(_,g[1])),y(c,g[2])),y(l,g[3])),y(p,g[4]))},numeric.Dopri.prototype.at=function r(n){var e,i,t,u=Math.floor;if("number"!=typeof n){var $=n.length,o=Array($);for(e=$-1;-1!==e;--e)o[e]=this.at(n[e]);return o}var c=this.x;for(e=0,i=c.length-1;i-e>1;)c[t=u(.5*(e+i))]<=n?e=t:i=t;return this._at(n,e)},numeric.dopri=function r(n,e,i,t,u,$,o){void 0===u&&(u=1e-6),void 0===$&&($=1e3);var c,_,f,m,s,a,x,h,l,p,g=[n],v=[i],d=[t(n,i)],y=[],B=.2,D=[3/40,9/40],b=[44/45,-56/15,32/9],w=[19372/6561,-25360/2187,64448/6561,-212/729],F=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],A=[35/384,0,500/1113,125/192,-2187/6784,11/84],C=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],E=[.2,.3,.8,8/9,1,1],k=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],j=0,S=(e-n)/10,V=0,P=numeric.add,q=numeric.mul,L=Math.min,M=Math.abs,O=numeric.norminf,U=Math.pow,N=numeric.any,R=numeric.lt,X=numeric.and;numeric.sub;var Y=new numeric.Dopri(g,v,d,y,-1,"");for("function"==typeof o&&(Q=o(n,i));n<e&&V<$;){if(++V,n+S>e&&(S=e-n),c=t(n+E[0]*S,P(i,q(B*S,d[j]))),_=t(n+E[1]*S,P(P(i,q(D[0]*S,d[j])),q(D[1]*S,c))),f=t(n+E[2]*S,P(P(P(i,q(b[0]*S,d[j])),q(b[1]*S,c)),q(b[2]*S,_))),m=t(n+E[3]*S,P(P(P(P(i,q(w[0]*S,d[j])),q(w[1]*S,c)),q(w[2]*S,_)),q(w[3]*S,f))),s=t(n+E[4]*S,P(P(P(P(P(i,q(F[0]*S,d[j])),q(F[1]*S,c)),q(F[2]*S,_)),q(F[3]*S,f)),q(F[4]*S,m))),l=P(P(P(P(P(i,q(d[j],S*A[0])),q(_,S*A[2])),q(f,S*A[3])),q(m,S*A[4])),q(s,S*A[5])),a=t(n+S,l),(p="number"==typeof(x=P(P(P(P(P(q(d[j],S*k[0]),q(_,S*k[2])),q(f,S*k[3])),q(m,S*k[4])),q(s,S*k[5])),q(a,S*k[6])))?M(x):O(x))>u){if(n+(S=.2*S*U(u/p,.25))===n){Y.msg="Step size became too small";break}continue}if(y[j]=P(P(P(P(P(P(i,q(d[j],S*C[0])),q(_,S*C[2])),q(f,S*C[3])),q(m,S*C[4])),q(s,S*C[5])),q(a,S*C[6])),g[++j]=n+S,v[j]=l,d[j]=a,"function"==typeof o){var Q,I,Z,H,z,G=n,W=n+.5*S;if(I=o(W,y[j-1]),N(Z=X(R(Q,0),R(0,I)))||(G=W,W=n+S,Q=I,I=o(W,l),Z=X(R(Q,0),R(0,I))),N(Z)){for(var J,K,rr=0,rn=1,re=1;;){if("number"==typeof Q)z=(re*I*G-rn*Q*W)/(re*I-rn*Q);else for(z=W,h=Q.length-1;-1!==h;--h)Q[h]<0&&I[h]>0&&(z=L(z,(re*I[h]*G-rn*Q[h]*W)/(re*I[h]-rn*Q[h])));if(z<=G||z>=W)break;H=Y._at(z,j-1),K=o(z,H),N(J=X(R(Q,0),R(0,K)))?(W=z,I=K,Z=J,re=1,-1===rr?rn*=.5:rn=1,rr=-1):(G=z,Q=K,rn=1,1===rr?re*=.5:re=1,rr=1)}return l=Y._at(.5*(n+z),j-1),Y.f[j]=t(z,H),Y.x[j]=z,Y.y[j]=H,Y.ymid[j-1]=l,Y.events=Z,Y.iterations=V,Y}}n+=S,i=l,Q=I,S=L(.8*S*U(u/p,.25),4*S)}return Y.iterations=V,Y},numeric.LU=function(r,n){n=n||!1;var e,i,t,u,$,o,c,_,f,m=Math.abs,s=r.length,a=s-1,x=Array(s);for(n||(r=numeric.clone(r)),t=0;t<s;++t){for(c=t,f=m((o=r[t])[t]),i=t+1;i<s;++i)f<(u=m(r[i][t]))&&(f=u,c=i);for(x[t]=c,c!=t&&(r[t]=r[c],r[c]=o,o=r[t]),$=o[t],e=t+1;e<s;++e)r[e][t]/=$;for(e=t+1;e<s;++e){for(_=r[e],i=t+1;i<a;++i)_[i]-=_[t]*o[i],++i,_[i]-=_[t]*o[i];i===a&&(_[i]-=_[t]*o[i])}}return{LU:r,P:x}},numeric.LUsolve=function r(n,e){var i,t,u,$,o,c=n.LU,_=c.length,f=numeric.clone(e),m=n.P;for(i=_-1;-1!==i;--i)f[i]=e[i];for(i=0;i<_;++i)for(u=m[i],m[i]!==i&&(o=f[i],f[i]=f[u],f[u]=o),$=c[i],t=0;t<i;++t)f[i]-=f[t]*$[t];for(i=_-1;i>=0;--i){for($=c[i],t=i+1;t<_;++t)f[i]-=f[t]*$[t];f[i]/=$[i]}return f},numeric.solve=function r(n,e,i){return numeric.LUsolve(numeric.LU(n,i),e)},numeric.echelonize=function r(n){var e,i,t,u,$,o,c,_,f=numeric.dim(n),m=f[0],s=f[1],a=numeric.identity(m),x=Array(m),h=Math.abs,l=numeric.diveq;for(e=0,n=numeric.clone(n);e<m;++e){for(i=1,t=0,$=n[e],o=a[e];i<s;++i)h($[t])<h($[i])&&(t=i);for(x[e]=t,l(o,$[t]),l($,$[t]),i=0;i<m;++i)if(i!==e){for(_=(c=n[i])[t],u=s-1;-1!==u;--u)c[u]-=$[u]*_;for(c=a[i],u=m-1;-1!==u;--u)c[u]-=o[u]*_}}return{I:a,A:n,P:x}},numeric.__solveLP=function r(n,e,i,t,u,$,o){var c,_=numeric.sum,f=(numeric.log,numeric.mul),m=numeric.sub,s=numeric.dot,a=numeric.div,x=numeric.add,h=n.length,l=i.length,p=!1,g=0,v=1;numeric.transpose(e),numeric.svd;var d=numeric.transpose,y=(numeric.leq,Math.sqrt),B=Math.abs;numeric.muleq,numeric.norminf,numeric.any;var D,b=Math.min,w=numeric.all,F=numeric.gt,A=Array(h),C=Array(l);numeric.rep([l],1);var E,k=numeric.solve,j=m(i,s(e,$)),S=s(n,n);for(E=g;E<u;++E){for(P=l-1;-1!==P;--P)C[P]=a(e[P],j[P]);var V,P,q,L=d(C);for(P=h-1;-1!==P;--P)A[P]=_(L[P]);v=.25*B(S/s(n,A));var M=100*y(S/s(A,A));for((!isFinite(v)||v>M)&&(v=M),V=x(n,f(v,A)),D=s(L,C),P=h-1;-1!==P;--P)D[P][P]+=1;q=k(D,a(V,v),!0);var O=a(j,s(e,q)),U=1;for(P=l-1;-1!==P;--P)O[P]<0&&(U=b(U,-.999*O[P]));if(c=m($,f(q,U)),j=m(i,s(e,c)),!w(F(j,0)))return{solution:$,message:"",iterations:E};if($=c,v<t)return{solution:c,message:"",iterations:E};if(o){var N=s(n,V),R=s(e,V);for(p=!0,P=l-1;-1!==P;--P)if(N*R[P]<0){p=!1;break}}else p=!($[h-1]>=0);if(p)return{solution:c,message:"Unbounded",iterations:E}}return{solution:$,message:"maximum iteration count exceeded",iterations:E}},numeric._solveLP=function r(n,e,i,t,u){var $,o=n.length,c=i.length;numeric.sum,numeric.log,numeric.mul;var _=numeric.sub,f=numeric.dot;numeric.div,numeric.add;var m=numeric.rep([o],0).concat([1]),s=numeric.rep([c,1],-1),a=numeric.blockMatrix([[e,s]]),x=i,$=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(i)))+1),h=numeric.__solveLP(m,a,x,t,u,$,!1),l=numeric.clone(h.solution);if(l.length=o,0>numeric.inf(_(i,f(e,l))))return{solution:NaN,message:"Infeasible",iterations:h.iterations};var p=numeric.__solveLP(n,e,i,t,u-h.iterations,l,!0);return p.iterations+=h.iterations,p},numeric.solveLP=function r(n,e,i,t,u,$,o){if(void 0===o&&(o=1e3),void 0===$&&($=numeric.epsilon),void 0===t)return numeric._solveLP(n,e,i,$,o);var c,_=t.length,f=t[0].length,m=e.length,s=numeric.echelonize(t),a=numeric.rep([f],0),x=s.P,h=[];for(c=x.length-1;-1!==c;--c)a[x[c]]=1;for(c=f-1;-1!==c;--c)0===a[c]&&h.push(c);var l=numeric.getRange,p=numeric.linspace(0,_-1),g=numeric.linspace(0,m-1),v=l(t,p,h),d=l(e,g,x),y=l(e,g,h),B=numeric.dot,D=numeric.sub,b=B(d,s.I),w=D(y,B(b,v)),F=D(i,B(b,u)),A=Array(x.length),C=Array(h.length);for(c=x.length-1;-1!==c;--c)A[c]=n[x[c]];for(c=h.length-1;-1!==c;--c)C[c]=n[h[c]];var E=D(C,B(A,B(s.I,v))),k=numeric._solveLP(E,w,F,$,o),j=k.solution;if(j!=j)return k;var S=B(s.I,D(u,B(v,j))),V=Array(n.length);for(c=x.length-1;-1!==c;--c)V[x[c]]=S[c];for(c=h.length-1;-1!==c;--c)V[h[c]]=j[c];return{solution:V,message:k.message,iterations:k.iterations}},numeric.MPStoLP=function r(n){n instanceof String&&n.split("\n");var e,i,t,u,$=0,o=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],c=n.length,_=0,f={},m=[],s=0,a={},x=0,h=[],l=[],p=[];function g(r){throw Error("MPStoLP: "+r+"\nLine "+i+": "+n[i]+"\nCurrent state: "+o[$]+"\n")}for(i=0;i<c;++i){var v=(u=n[i]).match(/\S*/g),d=[];for(t=0;t<v.length;++t)""!==v[t]&&d.push(v[t]);if(0!==d.length){for(t=0;t<o.length&&u.substr(0,o[t].length)!==o[t];++t);if(t<o.length){if($=t,1===t&&(e=d[1]),6===t)return{name:e,c:h,A:numeric.transpose(l),b:p,rows:f,vars:a};continue}switch($){case 0:case 1:g("Unexpected line");case 2:switch(d[0]){case"N":0===_?_=d[1]:g("Two or more N rows");break;case"L":f[d[1]]=s,m[s]=1,p[s]=0,++s;break;case"G":f[d[1]]=s,m[s]=-1,p[s]=0,++s;break;case"E":f[d[1]]=s,m[s]=0,p[s]=0,++s;break;default:g("Parse error "+numeric.prettyPrint(d))}break;case 3:!a.hasOwnProperty(d[0])&&(a[d[0]]=x,h[x]=0,l[x]=numeric.rep([s],0),++x);var y=a[d[0]];for(t=1;t<d.length;t+=2){if(d[t]===_){h[y]=parseFloat(d[t+1]);continue}var B=f[d[t]];l[y][B]=(m[B]<0?-1:1)*parseFloat(d[t+1])}break;case 4:for(t=1;t<d.length;t+=2)p[f[d[t]]]=(m[f[d[t]]]<0?-1:1)*parseFloat(d[t+1]);break;case 5:break;case 6:g("Internal error")}}}g("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(r,n,e,i,t,u,$){function o(r){var n,i,t=this,u=r.length,$=0,o=t.i=t.j=t.m=0;for(t.S=[],t.c=[],u||(r=[u++]);$<e;)t.S[$]=$++;for($=0;$<e;$++)o=f(o+(n=t.S[$])+r[$%u]),i=t.S[o],t.S[$]=i,t.S[o]=n;t.g=function r(n){var i=t.S,u=f(t.i+1),$=i[u],o=f(t.j+$),c=i[o];i[u]=c,i[o]=$;for(var _=i[f($+c)];--n;)$=i[u=f(u+1)],c=i[o=f(o+$)],i[u]=c,i[o]=$,_=_*e+i[f($+c)];return t.i=u,t.j=o,_},t.g(e)}function c(r,n,e,i,t){if(e=[],t=typeof r,n&&"object"==t){for(i in r)if(5>i.indexOf("S"))try{e.push(c(r[i],n-1))}catch(u){}}return e.length?e:r+("string"!=t?"\0":"")}function _(r,n,e,i){for(r+="",e=0,i=0;i<r.length;i++)n[f(i)]=f((e^=19*n[f(i)])+r.charCodeAt(i));for(i in r="",n)r+=String.fromCharCode(n[i]);return r}function f(r){return r&e-1}n.seedrandom=function f(m,s){var a,x=[];return m=_(c(s?[m,r]:arguments.length?m:[new Date().getTime(),r,window],3),x),_((a=new o(x)).S,r),n.random=function r(){for(var n=a.g(i),o=$,c=0;n<t;)n=(n+c)*e,o*=e,c=a.g(1);for(;n>=u;)n/=2,o/=2,c>>>=1;return(n+c)/o},m},$=n.pow(e,i),u=2*(t=n.pow(2,t)),_(n.random(),r)}([],numeric.seedrandom,256,6,52),function(r){function n(r){if("object"!=typeof r)return r;var e,i=[],t=r.length;for(e=0;e<t;e++)i[e+1]=n(r[e]);return i}function e(r){if("object"!=typeof r)return r;var n,i=[],t=r.length;for(n=1;n<t;n++)i[n-1]=e(r[n]);return i}function i(r,n,e){var i,t,u,$,o;for(u=1;u<=e;u+=1){for(i=1,r[u][u]=1/r[u][u],o=-r[u][u];i<u;i+=1)r[i][u]=o*r[i][u];if(e<($=u+1))break;for(t=$;t<=e;t+=1)for(i=1,o=r[u][t],r[u][t]=0;i<=u;i+=1)r[i][t]=r[i][t]+o*r[i][u]}}function t(r,n,e,i){var t,u,$,o;for(u=1;u<=e;u+=1){for(t=1,o=0;t<u;t+=1)o+=r[t][u]*i[t];i[u]=(i[u]-o)/r[u][u]}for($=1;$<=e;$+=1)for(t=1,i[u=e+1-$]=i[u]/r[u][u],o=-i[u];t<u;t+=1)i[t]=i[t]+o*r[t][u]}function u(r,n,e,i){var t,u,$,o,c,_;for(u=1;u<=e;u+=1){if(i[1]=u,_=0,($=u-1)<1){if((_=r[u][u]-_)<=0)break;r[u][u]=Math.sqrt(_)}else{for(o=1;o<=$;o+=1){for(t=1,c=r[o][u];t<o;t+=1)c-=r[t][u]*r[t][o];c/=r[o][o],r[o][u]=c,_+=c*c}if((_=r[u][u]-_)<=0)break;r[u][u]=Math.sqrt(_)}i[1]=0}}function $(r,n,e,$,o,c,_,f,m,s,a,x,h,l,p,g){var v,d,y,B,D,b,w,F,A,C,E,k,j,S,V,P,q,L,M,O,U,N,R,X,Y,Q,I;j=Math.min($,s),y=2*$+j*(j+5)/2+2*s+1,X=1e-60;do X+=X,Y=1+.1*X,Q=1+.2*X;while(Y<=1||Q<=1);for(v=1;v<=$;v+=1)p[v]=n[v];for(v=$+1;v<=y;v+=1)p[v]=0;for(v=1;v<=s;v+=1)x[v]=0;if(D=[],0===g[1]){if(u(r,e,$,D),0!==D[1]){g[1]=2;return}t(r,e,$,n),i(r,e,$)}else{for(d=1;d<=$;d+=1)for(v=1,o[d]=0;v<=d;v+=1)o[d]=o[d]+r[v][d]*n[v];for(d=1;d<=$;d+=1)for(n[d]=0,v=d;v<=$;v+=1)n[d]=n[d]+r[d][v]*o[v]}for(d=1,c[1]=0;d<=$;d+=1)for(o[d]=n[d],c[1]=c[1]+p[d]*o[d],p[d]=0,v=d+1;v<=$;v+=1)r[v][d]=0;for(v=1,c[1]=-c[1]/2,g[1]=0,S=(C=(A=(E=(F=(w=$)+$)+j)+j+1)+j*(j+1)/2)+s;v<=s;v+=1){for(d=1,P=0;d<=$;d+=1)P+=_[d][v]*_[d][v];p[S+v]=Math.sqrt(P)}function Z(){for(v=1,l[1]=l[1]+1,y=C;v<=s;v+=1){for(y+=1,P=-f[v],d=1;d<=$;d+=1)P+=_[d][v]*o[d];if(Math.abs(P)<X&&(P=0),v>a)p[y]=P;else if(p[y]=-Math.abs(P),P>0){for(d=1;d<=$;d+=1)_[d][v]=-_[d][v];f[v]=-f[v]}}for(v=1;v<=h;v+=1)p[C+x[v]]=0;for(v=1,k=0,V=0;v<=s;v+=1)p[C+v]<V*p[S+v]&&(k=v,V=p[C+v]/p[S+v]);return 0===k?999:0}function H(){for(v=1;v<=$;v+=1){for(d=1,P=0;d<=$;d+=1)P+=r[d][v]*_[d][k];p[v]=P}for(v=1,B=w;v<=$;v+=1)p[B+v]=0;for(d=h+1;d<=$;d+=1)for(v=1;v<=$;v+=1)p[B+v]=p[B+v]+r[v][d]*p[d];for(N=!0,v=h;v>=1;v-=1){for(P=p[v],B=(y=A+v*(v+3)/2)-v,d=v+1;d<=h;d+=1)P-=p[y]*p[F+d],y+=d;if(P/=p[B],p[F+v]=P,x[v]<a||P<0)break;N=!1,b=v}if(!N)for(v=1,q=p[E+b]/p[F+b];v<=h&&!(x[v]<a)&&!(p[F+v]<0);v+=1)(V=p[E+v]/p[F+v])<q&&(q=V,b=v);for(P=0,v=w+1;v<=w+$;v+=1)P+=p[v]*p[v];if(Math.abs(P)<=X){if(N)return g[1]=1,999;for(v=1;v<=h;v+=1)p[E+v]=p[E+v]-q*p[F+v];return p[E+h+1]=p[E+h+1]+q,700}for(v=1,P=0;v<=$;v+=1)P+=p[w+v]*_[v][k];for(L=-p[C+k]/P,R=!0,!N&&q<L&&(L=q,R=!1),v=1;v<=$;v+=1)o[v]=o[v]+L*p[w+v],Math.abs(o[v])<X&&(o[v]=0);for(v=1,c[1]=c[1]+L*P*(L/2+p[E+h+1]);v<=h;v+=1)p[E+v]=p[E+v]-L*p[F+v];if(p[E+h+1]=p[E+h+1]+L,R){for(v=1,x[h+=1]=k,y=A+(h-1)*h/2+1;v<=h-1;v+=1)p[y]=p[v],y+=1;if(h===$)p[y]=p[$];else{for(v=$;v>=h+1&&0!==p[v]&&(M=Math.max(Math.abs(p[v-1]),Math.abs(p[v])),O=Math.min(Math.abs(p[v-1]),Math.abs(p[v])),V=p[v-1]>=0?Math.abs(M*Math.sqrt(1+O*O/(M*M))):-Math.abs(M*Math.sqrt(1+O*O/(M*M))),M=p[v-1]/V,O=p[v]/V,1!==M);v-=1){;if(0===M)for(d=1,p[v-1]=O*V;d<=$;d+=1)V=r[d][v-1],r[d][v-1]=r[d][v],r[d][v]=V;else for(d=1,p[v-1]=V,U=O/(1+M);d<=$;d+=1)V=M*r[d][v-1]+O*r[d][v],r[d][v]=U*(r[d][v-1]+V)-r[d][v],r[d][v-1]=V}p[y]=p[h]}}else{for(d=1,P=-f[k];d<=$;d+=1)P+=o[d]*_[d][k];if(k>a)p[C+k]=P;else if(p[C+k]=-Math.abs(P),P>0){for(d=1;d<=$;d+=1)_[d][k]=-_[d][k];f[k]=-f[k]}return 700}return 0}function z(){if(0===p[B=(y=A+b*(b+1)/2+1)+b]||(M=Math.max(Math.abs(p[B-1]),Math.abs(p[B])),O=Math.min(Math.abs(p[B-1]),Math.abs(p[B])),V=p[B-1]>=0?Math.abs(M*Math.sqrt(1+O*O/(M*M))):-Math.abs(M*Math.sqrt(1+O*O/(M*M))),M=p[B-1]/V,O=p[B]/V,1===M))return 798;if(0===M){for(v=b+1;v<=h;v+=1)V=p[B-1],p[B-1]=p[B],p[B]=V,B+=v;for(v=1;v<=$;v+=1)V=r[v][b],r[v][b]=r[v][b+1],r[v][b+1]=V}else{for(U=O/(1+M),v=b+1;v<=h;v+=1)V=M*p[B-1]+O*p[B],p[B]=U*(p[B-1]+V)-p[B],p[B-1]=V,B+=v;for(v=1;v<=$;v+=1)V=M*r[v][b]+O*r[v][b+1],r[v][b+1]=U*(r[v][b]+V)-r[v][b+1],r[v][b]=V}return 0}function G(){for(v=1,B=y-b;v<=b;v+=1)p[B]=p[y],y+=1,B+=1;return(p[E+b]=p[E+b+1],x[b]=x[b+1],(b+=1)<h)?797:0}function W(){return p[E+h]=p[E+h+1],p[E+h+1]=0,x[h]=0,h-=1,l[2]=l[2]+1,0}for(h=0,l[1]=0,l[2]=0,I=0;;){if(999===(I=Z()))return;for(;0!==(I=H());){if(999===I)return;if(700===I){if(b===h)W();else{for(;z(),797===(I=G()););W()}}}}}function o(r,i,t,u,o,c){r=n(r),i=n(i),t=n(t);var _,f,m,s,a,x,h=[],l=[],p=[],g=[],v=[];if(o=o||0,c=c?n(c):[void 0,0],u=u?n(u):[],f=r.length-1,m=t[1].length-1,!u)for(_=1;_<=m;_+=1)u[_]=0;for(_=1;_<=m;_+=1)l[_]=0;for(_=1,s=0,a=Math.min(f,m);_<=f;_+=1)p[_]=0;for(_=1,h[1]=0;_<=2*f+a*(a+5)/2+2*m+1;_+=1)g[_]=0;for(_=1;_<=2;_+=1)v[_]=0;return $(r,i,f,f,p,h,t,u,f,m,o,l,s,v,g,c),x="",1===c[1]&&(x="constraints are inconsistent, no solution!"),2===c[1]&&(x="matrix D in quadratic function is not positive definite!"),{solution:e(p),value:e(h),unconstrained_solution:e(i),iterations:e(v),iact:e(l),message:x}}r.solveQP=o}(numeric),numeric.svd=function r(n){var e,i=numeric.epsilon,t=1e-64/i,u=50,$=0,o=0,c=0,_=0,f=0,m=numeric.clone(n),s=m.length,a=m[0].length;if(s<a)throw"Need more rows than columns";var x=Array(a),h=Array(a);for(o=0;o<a;o++)x[o]=h[o]=0;var l=numeric.rep([a,a],0);function p(r,n){return(r=Math.abs(r))>(n=Math.abs(n))?r*Math.sqrt(1+n*n/r/r):0==n?r:n*Math.sqrt(1+r*r/n/n)}var g=0,v=0,d=0,y=0,B=0,D=0,b=0;for(o=0;o<a;o++){for(x[o]=v,b=0,f=o+1,c=o;c<s;c++)b+=m[c][o]*m[c][o];if(b<=t)v=0;else for(g=m[o][o],v=Math.sqrt(b),g>=0&&(v=-v),d=g*v-b,m[o][o]=g-v,c=f;c<a;c++){for(b=0,_=o;_<s;_++)b+=m[_][o]*m[_][c];for(g=b/d,_=o;_<s;_++)m[_][c]+=g*m[_][o]}for(h[o]=v,b=0,c=f;c<a;c++)b+=m[o][c]*m[o][c];if(b<=t)v=0;else{for(g=m[o][o+1],v=Math.sqrt(b),g>=0&&(v=-v),d=g*v-b,m[o][o+1]=g-v,c=f;c<a;c++)x[c]=m[o][c]/d;for(c=f;c<s;c++){for(b=0,_=f;_<a;_++)b+=m[c][_]*m[o][_];for(_=f;_<a;_++)m[c][_]+=b*x[_]}}(B=Math.abs(h[o])+Math.abs(x[o]))>y&&(y=B)}for(o=a-1;-1!=o;o+=-1){if(0!=v){for(d=v*m[o][o+1],c=f;c<a;c++)l[c][o]=m[o][c]/d;for(c=f;c<a;c++){for(b=0,_=f;_<a;_++)b+=m[o][_]*l[_][c];for(_=f;_<a;_++)l[_][c]+=b*l[_][o]}}for(c=f;c<a;c++)l[o][c]=0,l[c][o]=0;l[o][o]=1,v=x[o],f=o}for(o=a-1;-1!=o;o+=-1){for(f=o+1,v=h[o],c=f;c<a;c++)m[o][c]=0;if(0!=v){for(d=m[o][o]*v,c=f;c<a;c++){for(b=0,_=f;_<s;_++)b+=m[_][o]*m[_][c];for(g=b/d,_=o;_<s;_++)m[_][c]+=g*m[_][o]}for(c=o;c<s;c++)m[c][o]=m[c][o]/v}else for(c=o;c<s;c++)m[c][o]=0;m[o][o]+=1}for(i*=y,_=a-1;-1!=_;_+=-1)for(var w=0;w<u;w++){var F=!1;for(f=_;-1!=f;f+=-1){if(Math.abs(x[f])<=i){F=!0;break}if(Math.abs(h[f-1])<=i)break}if(!F){$=0,b=1;var A=f-1;for(o=f;o<_+1&&(g=b*x[o],x[o]=$*x[o],!(Math.abs(g)<=i));o++)for(c=0,d=p(g,v=h[o]),h[o]=d,$=v/d,b=-g/d;c<s;c++)B=m[c][A],D=m[c][o],m[c][A]=B*$+D*b,m[c][o]=-B*b+D*$}if(D=h[_],f==_){if(D<0)for(c=0,h[_]=-D;c<a;c++)l[c][_]=-l[c][_];break}if(w>=u-1)throw"Error: no convergence.";for(y=h[f],B=h[_-1],v=p(g=((B-D)*(B+D)+((v=x[_-1])-(d=x[_]))*(v+d))/(2*d*B),1),g=g<0?((y-D)*(y+D)+d*(B/(g-v)-d))/y:((y-D)*(y+D)+d*(B/(g+v)-d))/y,$=1,b=1,o=f+1;o<_+1;o++){for(v=x[o],B=h[o],d=b*v,v*=$,D=p(g,d),x[o-1]=D,g=y*($=g/D)+v*(b=d/D),v=-y*b+v*$,d=B*b,B*=$,c=0;c<a;c++)y=l[c][o-1],D=l[c][o],l[c][o-1]=y*$+D*b,l[c][o]=-y*b+D*$;for(c=0,D=p(g,d),h[o-1]=D,g=($=g/D)*v+(b=d/D)*B,y=-b*v+$*B;c<s;c++)B=m[c][o-1],D=m[c][o],m[c][o-1]=B*$+D*b,m[c][o]=-B*b+D*$}x[f]=0,x[_]=g,h[_]=y}for(o=0;o<h.length;o++)h[o]<i&&(h[o]=0);for(o=0;o<a;o++)for(c=o-1;c>=0;c--)if(h[c]<h[o]){for(_=0,$=h[c],h[c]=h[o],h[o]=$;_<m.length;_++)e=m[_][o],m[_][o]=m[_][c],m[_][c]=e;for(_=0;_<l.length;_++)e=l[_][o],l[_][o]=l[_][c],l[_][c]=e;o=c}return{U:m,S:h,V:l}};